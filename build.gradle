/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/8.1.1/samples
 */

plugins {
    id 'base'
}

def contentSrc = "proposal.adoc"
def htmlOut = "index.html"
def pdfOut = "proposal.pdf"
def slidedeckOut = "slidedeck.html"
def contentSrcDir = "$projectDir"
def contentSrcPath = "$projectDir/$contentSrc"
def contentBuildDir = "$projectDir/build"
def imagesDir = "$projectDir/images"
def imagesBuildDir = "$contentBuildDir/images"
def revealjsDir = "$projectDir/reveal.js"
def revealjsBuildDir = "$contentBuildDir/reveal.js"
//def contentBuildDir = "$buildDir"
//def contentHtmlPath = "$contentBuildDir/$htmlOut"
//def contentPdfPath = "$contentBuildDir/$pdfOut"

tasks.register('copyImagesToBuildDir', Copy) {
    from "$imagesDir"
    into "$imagesBuildDir"
}

tasks.register('copyRevealjsToBuildDir', Copy) {
    from "$revealjsDir"
    into "$revealjsBuildDir"
}

tasks.register('buildHTML', Exec) {
    commandLine "bash", "-c", "asciidoctor $contentSrc -D $contentBuildDir -o $htmlOut"
}

tasks.register('buildPDF', Exec) {
    commandLine "bash", "-c", "asciidoctor $contentSrc -D $contentBuildDir -o $pdfOut -r asciidoctor-pdf -b pdf"
}

tasks.register('buildPresentation', Exec) {
    dependsOn(copyImagesToBuildDir)
    dependsOn(copyRevealjsToBuildDir)
    commandLine "bash", "-c", "asciidoctor-revealjs $contentSrc -D $contentBuildDir -o $slidedeckOut"
}

tasks.named("assemble") {
    dependsOn(buildHTML)
    dependsOn(buildPDF)
    dependsOn(buildPresentation)
}

